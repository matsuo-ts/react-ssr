"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=require("./register-9eb87bae.js"),t=e(require("path")),s=e(require("fs-extra"));require("react"),require("slash"),require("lz-string"),require("urlsafe-base64");var n=e(require("fs"));require("recursive-readdir");var i=require("./helpers-7a4405ee.js"),a=e(require("memory-fs")),u=e(require("webpack"));require("webpack-merge"),require("mini-css-extract-plugin"),require("optimize-css-assets-webpack-plugin"),require("terser-webpack-plugin");var c=process.cwd(),o=require("unionfs").ufs,f=new a;o.use(n).use(f);var p=function(){var e=r.asyncToGenerator(r.regenerator.mark((function e(a){var p,g,d,q,l,v;return r.regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.removeSync(t.join(c,r.ssrConfig.distDir)),e.next=3,i.getEntry(f);case 3:return p=e.sent,g=i.slicedToArray(p,2),d=g[0],q=g[1],l=i.configureWebpack(d),(v=u(l)).inputFileSystem=o,e.next=12,new i.promise((function(e,s){v.run((function(i,u){i&&s(i.stack||i),u.hasErrors()&&s(u.toString());for(var o=function(e){var s=q[e],i=r.getPageId(s,"_");a.use("/_react-ssr/".concat(i,".css"),(function(e,s){var a=t.join(c,r.ssrConfig.distDir,"".concat(i,".css")),u=r.existsSync(a)?n.readFileSync(a).toString():"";s.writeHead(200,{"Content-Type":"text/css"}),s.end(u,"utf-8")})),a.use("/_react-ssr/".concat(i,".js"),(function(e,s){var a=t.join(c,r.ssrConfig.distDir,"".concat(i,".js")),u=n.readFileSync(a).toString();s.status(200).type(".js").send(u)}))},f=0;f<q.length;f++)o(f);e()}))}));case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();exports.default=p;
